---
permalink: maintain/decommissioning-disconnected-grid-nodes.html 
sidebar: sidebar 
keywords: storagegrid, disconnected nodes, decommission node 
summary: '현재 그리드에 연결되어 있지 않은 노드(상태가 알 수 없음 또는 관리 중단\)를 해제해야 할 수 있습니다.' 
---
= 연결이 끊긴 그리드 노드의 서비스 해제
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
현재 그리드에 연결되어 있지 않은 노드(상태가 알 수 없거나 관리상 중단된 노드)를 해제해야 할 수 있습니다.

.시작하기 전에
* 서비스 해제 시 고려 사항 및 서비스 해제 시 고려 link:considerations-for-decommissioning-admin-or-gateway-nodes.html["관리자 및 게이트웨이 노드"]link:considerations-for-decommissioning-storage-nodes.html["스토리지 노드"]사항을 이해합니다.
* 모든 필수 항목을 확보했습니다.
* 활성화된 데이터 복구 작업이 없도록 했습니다. 을 link:checking-data-repair-jobs.html["데이터 복구 작업을 확인합니다"]참조하십시오.
* 스토리지 노드 복구가 그리드의 어느 곳에서든 진행되고 있지 않음을 확인했습니다. 있는 경우 복구 과정에서 Cassandra 재구축이 완료될 때까지 기다려야 합니다. 그런 다음 해체 작업을 진행할 수 있습니다.
* 노드 서비스 해제 절차가 일시 중지되지 않는 한 노드 서비스 해제 절차가 실행되는 동안 다른 유지 보수 절차가 실행되지 않도록 했습니다.
* 서비스 해제하려는 연결이 끊긴 노드 또는 노드에 대한 * 서비스 해제 가능 * 열에 녹색 확인 표시가 포함됩니다.
* 프로비저닝 암호가 있습니다.


.이 작업에 대해
Health* 열에서 파란색 Unknown 아이콘  또는 회색 Administratively Down 아이콘을 image:../media/icon_alarm_gray_administratively_down.png["아이콘 사용자 다운"]찾아 연결이 끊어진 노드를 식별할 수 image:../media/icon_alarm_blue_unknown.png["알 수 없는 아이콘"]있습니다.

분리된 노드를 폐기하기 전에 다음 사항에 유의하십시오.

* 이 절차는 주로 연결이 끊긴 단일 노드를 제거하기 위한 것입니다. 그리드에 연결이 끊어진 노드가 여러 개 포함된 경우, 소프트웨어를 동시에 모두 해제해야 예기치 않은 결과가 발생할 가능성이 높아집니다.
+

CAUTION: 연결이 끊긴 스토리지 노드를 한 번에 두 개 이상 해제하는 경우 데이터가 손실될 수 있습니다. 을 link:considerations-for-decommissioning-storage-nodes.html#considerations-disconnected-storage-nodes["연결이 끊어진 스토리지 노드에 대한 고려 사항"]참조하십시오.

+

CAUTION: 소프트웨어 기반 메타데이터 전용 노드가 포함된 그리드에서 스토리지 노드를 해제할 때는 주의하십시오. store_both_objects 및 메타데이터로 구성된 모든 노드를 해제하면 그리드에서 객체를 저장하는 기능이 제거됩니다. 메타데이터 전용 스토리지 노드에 대한 자세한 내용은 을 link:../primer/what-storage-node-is.html#types-of-storage-nodes["스토리지 노드 유형"]참조하십시오.

* 연결이 끊긴 노드를 제거할 수 없는 경우(예: ADC 쿼럼에 필요한 스토리지 노드) 연결이 끊긴 다른 노드는 제거할 수 없습니다.


.단계
. 아카이브 노드(연결 해제되어야 함)를 해제하지 않는 한 연결이 끊어진 그리드 노드를 다시 온라인 상태로 전환하거나 복구해 보십시오.
+
자세한 내용은 을 link:warnings-and-considerations-for-grid-node-recovery.html["그리드 노드 복구 절차"] 참조하십시오.

. 연결이 끊긴 그리드 노드를 복구할 수 없고 연결이 끊긴 동안 노드 서비스를 해제하려면 해당 노드에 대한 확인란을 선택합니다.
+

NOTE: 그리드에 연결이 끊어진 노드가 여러 개 포함된 경우, 소프트웨어를 동시에 모두 해제해야 예기치 않은 결과가 발생할 가능성이 높아집니다.

+

CAUTION: 연결이 끊긴 여러 스토리지 노드를 선택하는 경우, 한 번에 둘 이상의 그리드 노드 해제를 선택할 때는 특히 주의하십시오. 복구할 수 없는 스토리지 노드가 두 개 이상 연결되어 있는 경우 기술 지원 부서에 문의하여 최상의 조치를 취하십시오.

. 프로비저닝 암호를 입력합니다.
+
서비스 해제 시작 * 버튼이 활성화됩니다.

. 서비스 해제 시작 * 을 클릭합니다.
+
연결이 끊긴 노드를 선택했으며 노드에 개체의 복사본만 있는 경우 개체 데이터가 손실된다는 경고가 나타납니다.

. 노드 목록을 검토하고 * OK * 를 클릭합니다.
+
서비스 해제 절차가 시작되고 각 노드에 대한 진행률이 표시됩니다. 절차 중에 그리드 구성 변경을 포함하는 새 복구 패키지가 생성됩니다.

. 새 복구 패키지를 사용할 수 있게 되는 즉시 링크를 클릭하거나 * 유지 관리 * > * 시스템 * > * 복구 패키지 * 를 선택하여 복구 패키지 페이지에 액세스합니다. 그런 다음 `.zip` 파일을 다운로드합니다.
+
의 지침을 link:downloading-recovery-package.html["복구 패키지를 다운로드하는 중입니다"]참조하십시오.

+

NOTE: 서비스 해제 절차 중 문제가 발생한 경우 그리드를 복구할 수 있도록 가능한 한 빨리 복구 패키지를 다운로드합니다.

+

CAUTION: 복구 패키지 파일은 StorageGRID 시스템에서 데이터를 가져오는 데 사용할 수 있는 암호화 키 및 암호가 포함되어 있으므로 안전하게 보호해야 합니다.

. 서비스 해제 페이지를 주기적으로 모니터링하여 선택한 모든 노드가 성공적으로 폐기되었는지 확인합니다.
+
스토리지 노드의 사용을 해제하는 데 며칠 또는 몇 주가 걸릴 수 있습니다. 모든 작업이 완료되면 노드 선택 목록이 성공 메시지와 함께 다시 표시됩니다. 분리된 스토리지 노드를 폐기한 경우 복구 작업이 시작되었다는 정보 메시지가 표시됩니다.

. 서비스 해제 절차의 일부로 노드가 자동으로 종료된 후 나머지 가상 머신 또는 사용 중지된 노드와 관련된 기타 리소스를 제거합니다.
+

CAUTION: 노드가 자동으로 종료될 때까지 이 단계를 수행하지 마십시오.

. 스토리지 노드를 폐기하는 경우 서비스 해제 프로세스 중에 자동으로 시작되는 * 복제된 데이터 * 및 * 삭제 코딩(EC) 데이터 * 복구 작업의 상태를 모니터링합니다.


[role="tabbed-block"]
====
.복제된 데이터
--
* 복제된 복구의 예상 완료율을 얻으려면 repair-data 명령에 옵션을 추가합니다 `show-replicated-repair-status`.
+
`repair-data show-replicated-repair-status`

* 수리가 완료되었는지 확인하려면:
+
.. 노드 * > * _ 복구되는 스토리지 노드 _ * > * ILM * 을 선택합니다.
.. 평가 섹션의 속성을 검토합니다. 복구가 완료되면 * Awaiting-all * 속성이 0 개체를 나타냅니다.


* 수리를 더 자세히 모니터링하려면:
+
.. 노드 * 를 선택합니다.
.. _GRID NAME_ * > * ILM * 을 선택합니다.
.. ILM 대기열 그래프 위에 커서를 올려 놓고 * Scan rate (objects/sec) * 속성 값을 확인합니다. 이 값은 그리드의 객체가 스캔되고 ILM을 위해 대기하는 속도입니다.
.. ILM 대기열 섹션에서 다음 속성을 확인합니다.
+
*** * 스캔 기간 - 추정 * : 모든 개체의 전체 ILM 스캔을 완료하는 데 걸리는 예상 시간입니다.
+
전체 검사를 수행한다고 해서 ILM이 모든 개체에 적용되었다고 보장할 수는 없습니다.

*** * Repairs attemed *: 시도한 복제된 데이터에 대한 총 개체 복구 작업 수입니다. 이 수는 스토리지 노드가 고위험 객체를 복구하려고 할 때마다 증가합니다. 그리드가 사용 중인 경우 위험이 높은 ILM 수리의 우선 순위가 지정됩니다.
+
복구 후 복제에 실패한 경우 동일한 객체 복구가 다시 증가할 수 있습니다. + 이러한 속성은 스토리지 노드 볼륨 복구 진행률을 모니터링할 때 유용할 수 있습니다. 시도한 수리 수가 더 이상 증가하지 않고 전체 검사가 완료된 경우 수리가 완료된 것일 수 있습니다.



.. 또는 및 `storagegrid_ilm_repairs_attempted` 에 대한 Prometheus 쿼리를 `storagegrid_ilm_scan_period_estimated_minutes` 제출합니다.




--
.삭제 코딩(EC) 데이터
--
삭제 코딩 데이터의 복구를 모니터링하고 실패한 요청을 다시 시도하려면 다음을 수행하십시오.

. 삭제 코딩 데이터 복구 상태를 확인합니다.
+
** 현재 작업의 예상 완료 시간과 완료 비율을 보려면 * 지원 * > * 도구 * > * 메트릭 * 을 선택합니다. 그런 다음 Grafana 섹션에서 * EC 개요 * 를 선택합니다. Grid EC Job Ec Job Estimated Time to Completion * 및 * Grid EC Job Percentage Completed * 대시보드를 확인합니다.
** 다음 명령을 사용하여 특정 작업의 상태를 `repair-data` 확인합니다.
+
`repair-data show-ec-repair-status --repair-id repair ID`

** 이 명령을 사용하여 모든 수리를 나열합니다.
+
`repair-data show-ec-repair-status`

+
출력에는 이전 및 현재 실행 중인 모든 수리에 대한 정보가 `repair ID` 표시됩니다.



. 출력에 복구 작업이 실패했다고 표시되는 경우 옵션을 사용하여 `--repair-id` 복구를 재시도합니다.
+
이 명령은 복구 ID 6949309319275667690을 사용하여 실패한 노드 복구를 재시도합니다.

+
`repair-data start-ec-node-repair --repair-id 6949309319275667690`

+
이 명령은 복구 ID 6949309319275667690을 사용하여 실패한 볼륨 복구를 다시 시도합니다.

+
`repair-data start-ec-volume-repair --repair-id 6949309319275667690`



--
====
.작업을 마친 후
연결이 끊긴 노드를 폐기하고 모든 데이터 복구 작업이 완료되는 즉시 연결된 모든 그리드 노드를 필요에 따라 해제할 수 있습니다.

그런 다음 서비스 해제 절차를 완료한 후 다음 단계를 완료합니다.

* 해체된 그리드 노드의 드라이브가 깨끗하게 지워졌는지 확인합니다. 상용 데이터 삭제 도구 또는 서비스를 사용하여 드라이브에서 데이터를 영구적으로 안전하게 제거합니다.
* 어플라이언스 노드를 폐기했고 어플라이언스의 데이터가 노드 암호화를 사용하여 보호된 경우 StorageGRID 어플라이언스 설치 프로그램을 사용하여 키 관리 서버 구성을 지웁니다(KMS 지우기). 다른 그리드에 어플라이언스를 추가하려면 KMS 구성을 지워야 합니다. 자세한 내용은 을 https://docs.netapp.com/us-en/storagegrid-appliances/commonhardware/monitoring-node-encryption-in-maintenance-mode.html["유지보수 모드에서 노드 암호화를 모니터링합니다"^]참조하십시오.

