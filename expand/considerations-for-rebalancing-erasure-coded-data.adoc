---
permalink: expand/considerations-for-rebalancing-erasure-coded-data.html 
sidebar: sidebar 
keywords: erasure coding, rebalance, ec rebalance, site rebalance 
summary: 스토리지 노드를 추가하기 위해 확장을 수행하고 ILM 규칙을 사용하여 데이터를 삭제할 경우 사용 중인 삭제 코딩 체계에 대해 충분한 스토리지 노드를 추가할 수 없는 경우 EC 균형 조정 절차를 수행해야 할 수 있습니다. 
---
= 삭제 코딩 데이터의 재조정에 대한 고려사항
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
스토리지 노드를 추가하기 위해 확장을 수행하고 ILM 규칙을 사용하여 코드 데이터를 삭제하는 경우 사용 중인 삭제 코딩 체계에 스토리지 노드를 충분히 추가할 수 없는 경우 EC(삭제 코딩) 재조정 절차를 수행해야 할 수 있습니다.

이러한 고려 사항을 검토한 후 확장을 수행한 다음 로 link:rebalancing-erasure-coded-data-after-adding-storage-nodes.html["스토리지 노드를 추가한 후 삭제 코딩 데이터의 균형을 재조정합니다"] 이동하여 절차를 실행합니다.



== EC 재조정 이란 무엇입니까?

EC 재조정은 스토리지 노드 확장 후 필요할 수 있는 StorageGRID 절차입니다. 이 절차는 기본 관리 노드에서 명령줄 스크립트로 실행됩니다. EC 균형 조정 절차를 실행하면 StorageGRID는 삭제 코딩 조각을 사이트에서 기존 스토리지 노드와 새로 추가된 스토리지 노드 간에 재분배합니다.

EC 재조정 절차:

* 삭제 코딩 오브젝트 데이터만 이동합니다. 복제된 오브젝트 데이터는 이동하지 않습니다.
* 사이트 내에서 데이터를 재배포합니다. 사이트 간에 데이터를 이동하지 않습니다.
* 사이트의 모든 스토리지 노드 간에 데이터를 재배포합니다. 스토리지 볼륨 내에서 데이터를 재배포하지 않습니다.
* 에서는 삭제 코딩 데이터를 이동할 위치를 결정할 때 각 스토리지 노드에서 복제된 데이터 사용을 고려하지 않습니다.
* 각 노드의 상대적 용량을 고려하지 않고 삭제 코딩 데이터를 스토리지 노드 간에 균등하게 다시 분산합니다.
* 에서 삭제 코딩 데이터를 80% 이상 차 있는 스토리지 노드에 배포하지 않습니다.
* ILM 작업 및 S3 클라이언트 작업 실행 시 &#8212를 줄일 수 있음. 삭제 코딩 조각을 재배포하기 위해 추가 리소스가 필요합니다.


EC 재조정 절차가 완료되면 다음을 수행합니다.

* 삭제 코딩 데이터는 사용 가능한 공간이 적은 스토리지 노드에서 사용 가능한 공간이 더 많은 스토리지 노드로 이동됩니다.
* 삭제 코딩 오브젝트의 데이터 보호는 변경되지 않습니다.
* 사용된 (%) 값은 다음 두 가지 이유로 스토리지 노드 간에 다를 수 있습니다.
+
** 복제된 오브젝트 복사본은 기존 노드 &#8212의 공간을 계속 사용합니다. EC 재조정 절차는 복제된 데이터를 이동하지 않습니다.
** 모든 노드가 비슷한 양의 삭제 코딩 데이터로 끝나더라도 용량이 큰 노드는 용량이 작은 노드보다 용량이 적은 노드로 비교적 적게 가득 차게 됩니다.
+
예를 들어, 200TB 노드 3개가 각각 80%(200 및 #215, 0.8 = 160TB, 사이트의 경우 480TB)로 채워졌다고 가정합니다. 400TB 노드를 추가하고 재조정 절차를 실행하면 모든 노드에 대략 동일한 양의 삭제 코드 데이터(480/4 = 120TB)가 제공됩니다. 그러나 더 큰 노드에 사용된 (%)은 더 작은 노드에 사용된 (%)보다 작습니다.

+
image::../media/used_space_with_larger_node.png[확장 전에 사용된 공간입니다]







== 언제 삭제 코딩 데이터의 균형을 재조정할 수 있으며

다음 시나리오를 고려해 보십시오.

* StorageGRID는 단일 사이트에서 실행 중이며 3개의 스토리지 노드가 있습니다.
* ILM 정책은 1.0 MB보다 큰 모든 개체에 2+1 삭제 코딩 규칙을 사용하고 더 작은 개체에 2-복사 복제 규칙을 사용합니다.
* 모든 스토리지 노드가 꽉 찼습니다. 주요 심각도 수준에서 * Low Object Storage * 경고가 트리거되었습니다.
+
image::../media/used_space_before_expansion.png[확장 전에 사용된 공간입니다]





=== 노드를 충분히 추가하는 경우에는 재조정이 필요하지 않습니다

EC 균형 조정이 필요하지 않은 시기를 이해하려면 세 개 이상의 새 스토리지 노드를 추가했다고 가정합니다. 이 경우 EC 균형 조정을 수행할 필요가 없습니다. 원래 스토리지 노드가 가득 찬 상태로 유지되지만 새 오브젝트는 이제 2+1 삭제 코딩 및 #8212에 3개의 새 노드를 사용합니다. 두 데이터 조각과 하나의 패리티 조각을 각각 다른 노드에 저장할 수 있습니다.

image::../media/used_space_after_3_node_expansion.png[3노드 확장 후 사용된 공간입니다]


CAUTION: 이 경우 EC 재조정 절차를 실행할 수 있지만 기존 삭제 코딩 데이터를 이동하면 그리드 성능이 일시적으로 저하되어 클라이언트 작업에 영향을 줄 수 있습니다.



=== 노드를 충분히 추가할 수 없는 경우 재조정이 필요합니다

EC 균형 조정이 필요한 시기를 이해하려면 세 개가 아닌 두 개의 스토리지 노드만 추가할 수 있다고 가정합니다. 2+1 구성표에 사용 가능한 공간이 세 개 이상의 스토리지 노드가 필요하므로 빈 노드는 새로운 삭제 코딩 데이터에 사용할 수 없습니다.

image::../media/used_space_after_2_node_expansion.png[2노드 확장 후 사용된 공간입니다]

새 스토리지 노드를 사용하려면 EC 재조정 절차를 실행해야 합니다. 이 절차를 실행하면 StorageGRID는 사이트의 모든 스토리지 노드 간에 기존의 삭제 코딩 데이터 및 패리티 조각을 재배포합니다. 이 예에서 EC 재조정 절차가 완료되면 5개 노드 모두 60%만 채워지고 모든 스토리지 노드의 2+1 삭제 코딩 체계에 오브젝트가 계속 수집될 수 있습니다.

image::../media/used_space_after_ec_rebalance.png[사용된 공간 EC 재조정 후]



== EC 재조정 권장 사항

다음 중 _ALL_이 맞으면 NetApp에서 EC 재조정을 요구합니다.

* 오브젝트 데이터에 삭제 코딩을 사용합니다.
* 사이트의 하나 이상의 스토리지 노드에 대해 * Low Object Storage * 알림이 트리거되어 노드가 80% 이상 꽉 찼음을 나타냅니다.
* 사용 중인 삭제 코딩 구성표에 사용할 새 스토리지 노드를 추가할 수 없습니다. 을 link:adding-storage-capacity-for-erasure-coded-objects.html["삭제 코딩 오브젝트를 위한 스토리지 용량을 추가합니다"]참조하십시오.
* S3 클라이언트는 EC 재조정 절차가 실행되는 동안 쓰기 및 읽기 작업에 대해 낮은 성능을 허용할 수 있습니다.


스토리지 노드를 비슷한 수준으로 채우도록 하고 EC 재조정 절차가 실행되는 동안 S3 클라이언트에서 쓰기 및 읽기 작업 성능이 저하될 수 있는 경우 선택적으로 EC 재조정 절차를 실행할 수 있습니다.



== EC 재조정 절차가 다른 유지 관리 작업과 상호 작용하는 방식

EC 재조정 절차를 실행하는 동시에 특정 유지보수 절차를 수행할 수 없습니다.

[cols="1a,2a"]
|===
| 절차를 참조하십시오 | EC 재조정 절차 중에 허용됩니까? 


 a| 
EC 재조정 절차 추가
 a| 
아니요

한 번에 하나의 EC 재조정 절차만 실행할 수 있습니다.



 a| 
서비스 해제 절차

EC 데이터 복구 작업
 a| 
아니요

* EC 재조정 절차가 실행되는 동안에는 파기 절차 또는 EC 데이터 복구를 시작할 수 없습니다.
* 스토리지 노드 서비스 해제 절차 또는 EC 데이터 복구가 실행 중인 동안에는 EC 재조정 절차를 시작할 수 없습니다.




 a| 
확장 절차
 a| 
아니요

확장 시 새 스토리지 노드를 추가해야 하는 경우 모든 새 노드를 추가한 후 EC 균형 조정 절차를 실행합니다.



 a| 
업그레이드 절차
 a| 
아니요

StorageGRID 소프트웨어를 업그레이드해야 하는 경우 EC 재조정 절차를 실행하기 전이나 후에 업그레이드 절차를 수행합니다. 필요에 따라 EC 재조정 절차를 종료하여 소프트웨어 업그레이드를 수행할 수 있습니다.



 a| 
어플라이언스 노드 클론 절차
 a| 
아니요

어플라이언스 스토리지 노드를 복제해야 하는 경우 새 노드를 추가한 후 EC 재조정 절차를 실행합니다.



 a| 
핫픽스 절차
 a| 
예.

EC 재조정 절차가 실행되는 동안 StorageGRID 핫픽스를 적용할 수 있습니다.



 a| 
기타 유지보수 절차
 a| 
아니요

다른 유지보수 절차를 실행하기 전에 EC 재조정 절차를 종료해야 합니다.

|===


== EC 재조정 절차가 ILM과 상호 작용하는 방법

EC 재조정 절차가 실행되는 동안 기존 삭제 코딩 오브젝트의 위치를 변경할 수 있는 ILM을 변경하지 마십시오. 예를 들어 삭제 코딩 프로필이 다른 ILM 규칙을 사용하지 마십시오. 이러한 ILM을 변경해야 하는 경우 EC 재조정 절차를 종료해야 합니다.
