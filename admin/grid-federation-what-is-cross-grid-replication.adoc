---
permalink: admin/grid-federation-what-is-cross-grid-replication.html 
sidebar: sidebar 
keywords: cross-grid replication, cgr, disaster recovery, grid federation 
summary: 그리드 간 복제는 그리드 페더레이션 연결에 연결된 두 StorageGRID 시스템에서 선택한 S3 버킷 간에 오브젝트를 자동으로 복제하는 것입니다. 교차 그리드 복제에는 계정 클론이 필요합니다. 
---
= 교차 그리드 복제란 무엇입니까?
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
그리드 간 복제는 에 연결된 두 StorageGRID 시스템에서 선택한 S3 버킷 간에 오브젝트를 자동 복제하는 것입니다link:grid-federation-overview.html["그리드 페더레이션 연결"]. link:grid-federation-what-is-account-clone.html["계정 클론"] 그리드 간 복제에 필요합니다.



== 그리드 간 복제를 위한 워크플로우

워크플로 다이어그램은 두 그리드의 버킷 간에 크로스 그리드 복제를 구성하는 단계를 요약한 것입니다.

image::../media/grid-federation-cgr-workflow.png[교차 그리드 복제 워크플로우]



== 크로스 그리드 복제 요구 사항

테넌트 계정에 하나 이상의 그리드 페더레이션 연결을 사용할 수 있는 *그리드 페더레이션 연결 사용* 권한이 있는 경우link:grid-federation-overview.html["그리드 페더레이션 연결"] 루트 액세스 권한이 있는 테넌트 사용자는 각 그리드의 해당 테넌트 계정에 버킷을 생성할 수 있습니다.  이 버킷:

* 서로 다른 이름을 가질 수 있습니다
* 다른 지역을 가질 수 있습니다
* 버전 관리가 활성화되어 있어야 합니다
* 비어 있어야 합니다


두 버킷이 모두 생성된 후 크로스 그리드 복제를 둘 중 하나 또는 두 버킷에 대해 구성할 수 있습니다.

.자세한 정보
link:../tenant/grid-federation-manage-cross-grid-replication.html["교차 그리드 복제 관리"]



== 교차 그리드 복제의 작동 방식

그리드 간 복제를 단방향 또는 양방향으로 구성하여 수행할 수 있습니다.



=== 복제 기능을 제공합니다

한 그리드의 버킷에 대해서만 교차 그리드 복제를 활성화하는 경우 해당 버킷(소스 버킷)에 추가된 객체는 다른 그리드의 해당 버킷(대상 버킷)에 복제됩니다.  하지만 대상 버킷에 추가된 객체는 소스로 다시 복제되지 않습니다.  그림에서 크로스 그리드 복제가 활성화되었습니다. `my-bucket` 그리드 1에서 그리드 2로의 이동은 가능하지만 반대 방향으로는 활성화되어 있지 않습니다.

image::../media/grid-federation-cross-grid-replication-one-direction.png[그리드 페더레이션 연결을 한 방향으로 보여 주는 이미지입니다]



=== 양방향으로 복제

두 그리드에서 동일한 버킷에 대해 교차 그리드 복제를 활성화하면 두 버킷에 추가된 객체가 다른 그리드에 복제됩니다. 그림에서 교차 그리드 복제는 양방향으로 에 대해 `my-bucket` 활성화됩니다.

image::../media/grid-federation-cross-grid-replication.png[복제를 양방향으로 비교한 한 방향의 복제를 보여 주는 이미지입니다]



=== 오브젝트를 수집하면 어떻게 됩니까?

S3 클라이언트가 교차 그리드 복제를 사용하도록 설정된 버킷에 오브젝트를 추가하면 다음과 같은 현상이 발생합니다.

. StorageGRID는 소스 버킷에서 대상 버킷으로 오브젝트를 자동으로 복제합니다. 이 백그라운드 복제 작업을 수행하는 시간은 보류 중인 다른 복제 작업의 수를 비롯한 여러 요인에 따라 달라집니다.
+
S3 클라이언트는 GetObject 또는 HeadObject 요청을 실행하여 객체의 복제 상태를 확인할 수 있습니다.  응답에는 StorageGRID 관련 내용이 포함됩니다. `x-ntap-sg-cgr-replication-status` 다음 값 중 하나를 갖는 응답 헤더:

+
[cols="1a,2a"]
|===
| 그리드 | 복제 상태입니다 


 a| 
출처
 a| 
** * 완료 *: 모든 그리드 연결에 대해 복제가 성공했습니다.
** * 보류 중 *: 객체가 하나 이상의 그리드 연결에 복제되지 않았습니다.
** *실패*: 그리드 연결에 대한 복제가 보류되지 않았으며 적어도 하나는 영구적인 오류로 실패했습니다.  사용자는 오류를 해결해야 합니다.




 a| 
목적지
 a| 
* replica *: 객체가 소스 그리드에서 복제되었습니다.

|===
+

NOTE: StorageGRID 지원하지 않습니다 `x-amz-replication-status` 헤더.

. StorageGRID는 다른 오브젝트와 마찬가지로 각 그리드의 활성 ILM 정책을 사용하여 오브젝트를 관리합니다. 예를 들어, 그리드 1의 오브젝트 A는 두 개의 복제된 복사본으로 저장되고 영구적으로 보존되는 반면, 그리드 2에 복제된 오브젝트 A는 2+1 삭제 코딩을 사용하여 저장하고 3년 후에 삭제될 수 있습니다.




=== 오브젝트를 삭제하면 어떻게 됩니까?

에 설명된 대로 link:../primer/delete-data-flow.html["데이터 흐름을 삭제합니다"]StorageGRID는 다음과 같은 이유로 개체를 삭제할 수 있습니다.

* S3 클라이언트가 삭제 요청을 실행합니다.
* 테넌트 관리자 사용자는 link:../tenant/deleting-s3-bucket-objects.html["버킷에서 오브젝트를 삭제합니다"]버킷에서 모든 오브젝트를 제거하는 옵션을 선택합니다.
* 버킷에는 수명 주기 구성이 만료되어 있습니다.
* 개체에 대한 ILM 규칙의 마지막 기간이 종료되며 더 이상 지정된 배치가 없습니다.


StorageGRID가 버킷 작업, 버킷 수명 주기 만료 또는 ILM 배치 만료에서 오브젝트 삭제로 인해 오브젝트를 삭제하면 그리드 통합 연결의 다른 그리드에서 복제된 오브젝트는 삭제되지 않습니다. 하지만 S3 클라이언트에서 소스 버킷에 추가된 삭제 마커는 선택적으로 대상 버킷에 복제할 수 있습니다.

S3 클라이언트가 교차 그리드 복제가 활성화된 버킷에서 오브젝트를 삭제할 때 어떤 일이 발생하는지 이해하려면 S3 클라이언트가 버전 관리가 활성화된 버킷에서 오브젝트를 삭제하는 방법을 다음과 같이 검토하십시오.

* S3 클라이언트가 버전 ID가 포함된 삭제 요청을 실행하면 해당 오브젝트 버전이 영구적으로 제거됩니다. 버킷에 추가된 삭제 마커가 없습니다.
* S3 클라이언트가 버전 ID를 포함하지 않는 삭제 요청을 발행하는 경우 StorageGRID 어떤 객체 버전도 삭제하지 않습니다.  대신 버킷에 삭제 마커를 추가합니다.  삭제 마커를 사용하면 StorageGRID 개체가 삭제된 것처럼 작동합니다.
+
** 버전 ID가 없는 GetObject 요청은 다음과 같이 실패합니다. `404 No Object Found`
** 유효한 버전 ID가 있는 GetObject 요청은 성공하고 요청된 개체 버전을 반환합니다.




S3 클라이언트가 교차 그리드 복제가 활성화된 버킷에서 오브젝트를 삭제하면 StorageGRID은 다음과 같이 삭제 요청을 대상에 복제할지 여부를 결정합니다.

* 삭제 요청에 버전 ID가 포함되어 있는 경우 해당 개체 버전은 소스 그리드에서 영구적으로 제거됩니다.  하지만 StorageGRID 버전 ID가 포함된 삭제 요청을 복제하지 않으므로 대상에서 동일한 개체 버전이 삭제되지 않습니다.
* 삭제 요청에 버전 ID가 포함되지 않은 경우 StorageGRID 버킷에 대해 크로스 그리드 복제가 구성된 방식에 따라 선택적으로 삭제 마커를 복제할 수 있습니다.
+
** 삭제 마커(기본값)를 복제하도록 선택하면 삭제 마커가 소스 버킷에 추가되고 대상 버킷에 복제됩니다. 실제로 두 그리드에서 오브젝트가 삭제된 것으로 나타납니다.
** 삭제 마커를 복제하지 않도록 선택하면 삭제 마커가 소스 버킷에 추가되지만 대상 버킷에는 복제되지 않습니다.  실제로 소스 그리드에서 삭제된 개체는 대상 그리드에서 삭제되지 않습니다.




그림에서 *삭제 마커 복제*는 *예*로 설정되었습니다.link:../tenant/grid-federation-manage-cross-grid-replication.html["교차 그리드 복제가 설정되었습니다"] .  버전 ID가 포함된 소스 버킷에 대한 삭제 요청은 대상 버킷의 개체를 삭제하지 않습니다.  버전 ID가 포함되지 않은 소스 버킷에 대한 삭제 요청은 대상 버킷의 객체를 삭제하는 것으로 보입니다.

image::../media/grid-federation-cross-grid-replication-delete.png[두 그리드에 복제 클라이언트 삭제를 보여 주는 이미지입니다]


NOTE: 그리드 간에 객체 삭제를 동기화된 상태로 유지하려면 link:../s3/create-s3-lifecycle-configuration.html["S3 라이프사이클 구성"]양쪽 그리드에서 버킷을 생성합니다.



=== 암호화된 개체가 복제되는 방식

교차 그리드 복제를 사용하여 그리드 간에 오브젝트를 복제할 때 개별 오브젝트를 암호화하거나 기본 버킷 암호화를 사용하거나 그리드 전체 암호화를 구성할 수 있습니다. 버킷에 대해 교차 그리드 복제를 활성화하기 전이나 후에 기본 버킷 또는 그리드 전체 암호화 설정을 추가, 수정 또는 제거할 수 있습니다.

개별 오브젝트를 암호화하려면 소스 버킷에 오브젝트를 추가할 때 SSE(StorageGRID 관리 키가 있는 서버 측 암호화)를 사용할 수 있습니다.  `x-amz-server-side-encryption`요청 헤더를 사용하고 를 지정하십시오 `AES256`. 을 link:../s3/using-server-side-encryption.html["서버측 암호화를 사용합니다"]참조하십시오.


NOTE: 고객이 제공한 키를 사용한 서버 측 암호화(SSE-C)는 크로스 그리드 복제에 지원되지 않습니다.  수집 작업이 실패합니다.

버킷에 기본 암호화를 사용하려면 PutBucketEncryption 요청을 사용하고 `SSEAlgorithm` 매개 변수를 로 `AES256`설정합니다. 버킷 수준 암호화는 요청 헤더 없이 수집된 모든 객체에 `x-amz-server-side-encryption` 적용됩니다. 을 link:../s3/operations-on-buckets.html["버킷 작업"]참조하십시오.

그리드 수준 암호화를 사용하려면 * 저장된 오브젝트 암호화 * 옵션을 * AES-256 * 로 설정합니다. 그리드 수준 암호화는 버킷 수준에서 암호화되지 않거나 요청 헤더 없이 수집된 모든 오브젝트에 `x-amz-server-side-encryption` 적용됩니다. 을 link:../admin/changing-network-options-object-encryption.html["네트워크 및 개체 옵션을 구성합니다"]참조하십시오.


NOTE: SSE는 AES-128을 지원하지 않습니다.  *AES-128* 옵션을 사용하여 소스 그리드에 대해 *저장된 개체 암호화* 옵션이 활성화된 경우, AES-128 알고리즘 사용이 복제된 개체로 전파되지 않습니다.  대신 복제된 개체는 대상의 기본 버킷이나 그리드 수준 암호화 설정(사용 가능한 경우)을 사용합니다.

소스 객체를 암호화하는 방법을 결정할 때 StorageGRID는 다음 규칙을 적용합니다.

.  `x-amz-server-side-encryption`인제스트 헤더가 있는 경우 사용합니다.
. 수집 헤더가 없으면 구성된 경우 버킷 기본 암호화 설정을 사용합니다.
. 버킷 설정이 구성되지 않은 경우, 구성된 경우 그리드 전체 암호화 설정을 사용합니다.
. 그리드 전체 설정이 없으면 소스 객체를 암호화하지 마세요.


복제된 개체를 암호화하는 방법을 결정할 때 StorageGRID는 다음 규칙을 다음 순서로 적용합니다.

. 해당 개체에서 AES-128 암호화를 사용하지 않는 한 소스 객체와 동일한 암호화를 사용합니다.
. 소스 개체가 암호화되지 않았거나 AES-128을 사용하는 경우 대상 버킷의 기본 암호화 설정(구성된 경우)을 사용합니다.
. 대상 버킷에 암호화 설정이 없으면 대상의 그리드 전체 암호화 설정(구성된 경우)을 사용합니다.
. 그리드 전체 설정이 없으면 대상 개체를 암호화하지 마세요.




=== S3 객체 잠금을 통한 크로스 그리드 복제

다음과 같은 상황에서 S3 개체 잠금이 활성화된 StorageGRID 버킷 간에 크로스 그리드 복제를 구성할 수 있습니다.

[cols="1a,1a"]
|===
| 소스 버킷의 S3 객체 잠금이 설정된 경우... | 그리고 대상 버킷의 S3 객체 잠금은... 


 a| 
활성화됨
 a| 
활성화됨



 a| 
장애가 있는
 a| 
활성화됨

|===
소스 버킷에서 S3 개체 잠금이 활성화된 경우:

* 대상에서 다음 순서대로 보존 설정을 사용하여 객체를 잠급니다.
+
.. 소스 개체의 보존 헤더 값:
+
`x-amz-object-lock-mode`

+
`x-amz-object-lock-retain-until-date`

.. 설정된 경우 소스 버킷의 기본 보존 기간입니다.
.. 설정된 경우 대상 버킷의 기본 보존 기간입니다.


+
대상 버킷의 기본 보존 기간은 소스 개체에서 복제된 보존 기간 설정보다 우선하지 않습니다.

* 다음을 사용하여 대상 개체에 대한 법적 보류 상태를 설정할 수 있습니다. `x-amz-object-lock-legal-hold` 객체를 업로드할 때.
* 대상 테넌트 또는 버킷이 소스 개체의 S3 개체 잠금 설정을 지원하지 않으면 오류가 발생합니다. 다음을 참조하세요. link:../admin/grid-federation-troubleshoot.html#cross-grid-replication-alerts-and-errors["그리드 간 복제 알림 및 오류."]


소스 버킷의 S3 개체 잠금이 비활성화된 경우:

* 대상 버킷에서 기본 보존 기간을 구성하여 대상 객체에 S3 객체 잠금 보존 기간을 적용할 수 있습니다.
* 대상 개체는 법적 보존 상태를 설정할 수 없습니다.




=== PutObjectTagging 및 DeleteObjectTagging은 지원되지 않습니다

PutObjectTagging 및 DeleteObjectTagging 요청은 교차 그리드 복제가 활성화된 버킷의 객체에 대해 지원되지 않습니다.

S3 클라이언트가 PutObjectTagging 또는 DeleteObjectTagging 요청을 발행하는 경우 `501 Not Implemented` 반환됩니다.  메시지는 `Put(Delete) ObjectTagging isn't available for buckets that have cross-grid replication configured` .



=== PutObjectRetention 및 PutObjectLegalHold는 지원되지 않습니다.

PutObjectRetention 및 PutObjectLegalHold 요청은 크로스 그리드 복제가 활성화된 버킷의 개체에 대해 완전히 지원되지 않습니다.

S3 클라이언트가 PutObjectRetention 또는 PutObjectLegalHold 요청을 실행하면 소스 개체의 설정이 수정되지만 변경 사항은 대상에 적용되지 않습니다.



=== 분할된 객체가 복제되는 방식

소스 그리드의 최대 세그먼트 크기는 대상 그리드에 복제된 개체에 적용됩니다.  객체가 다른 그리드에 복제되면 소스 그리드의 *최대 세그먼트 크기* 설정(*구성* > *시스템* > *저장소 옵션*)이 두 그리드 모두에 사용됩니다.  예를 들어, 소스 그리드의 최대 세그먼트 크기가 1GB이고 대상 그리드의 최대 세그먼트 크기가 50MB라고 가정해 보겠습니다.  소스 그리드에서 2GB 객체를 수집하는 경우 해당 객체는 두 개의 1GB 세그먼트로 저장됩니다.  해당 그리드의 최대 세그먼트 크기가 50MB인 경우에도 대상 그리드에 1GB 세그먼트 두 개로 복제됩니다.
